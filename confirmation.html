<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Confirmation – TN Ration Queue</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;600&display=swap" rel="stylesheet">
<style>
  body{
    font-family:Poppins,sans-serif;
    margin:0;
    background:linear-gradient(135deg,#22c55e,#fff,#f97316);
    display:flex;
    justify-content:center;
    align-items:center;
    min-height:100vh;
    padding:20px;
  }
  .card{
    background:rgba(255,255,255,.85);
    padding:30px;
    border-radius:15px;
    text-align:center;
    max-width:500px;
    width:90%;
    box-shadow:0 8px 20px rgba(0,0,0,.25);
  }
  .card img{width:90px;margin-bottom:15px}
  h2{color:#333;margin-bottom:10px}
  p{margin:8px 0}
  .btn{
    padding:10px 20px;
    margin-top:20px;
    border:none;
    border-radius:8px;
    background:linear-gradient(90deg,#f97316,#22c55e);
    color:#fff;
    font-weight:600;
    cursor:pointer;
    display:inline-block;
  }
  #dashBtn{display:none;} /* hidden until Confirm */
</style>
</head>
<body>
  <div class="card">
    <img src="images/TamilNadu_Logo.svg.png" alt="Logo">
    <h2>Booking Confirmation</h2>
    <p>Select your purchase date:</p>
    <input type="date" id="buyDate">
    <p id="slot"></p>
    <p id="token"></p>
    <button class="btn" onclick="finalize()">Confirm</button>
    <button class="btn" id="dashBtn" onclick="goDashboard()">Go to Dashboard</button>
  </div>

<script>
function randomTime(){
  const start=9, end=15; // 9 AM – 3 PM
  const hour=Math.floor(Math.random()*(end-start))+start;
  const min=Math.floor(Math.random()*60);
  return `${hour}:${min.toString().padStart(2,"0")}`;
}
function randomToken(){
  return "TN"+Math.floor(1000000000+Math.random()*9000000000);
}

function finalize(){
  const date=document.getElementById("buyDate").value;
  if(!date){
    alert("Please choose a date!");
    return;
  }

  const time=randomTime();
  const token=randomToken();
  document.getElementById("slot").textContent="Time: "+time;
  document.getElementById("token").textContent="Token: "+token;

  // Save to history
  const cart=JSON.parse(localStorage.getItem("cartItems"))||[];
  let history=JSON.parse(localStorage.getItem("purchaseHistory"))||[];
  cart.forEach(item=>{
    history.push({
      date:date,
      name:item.name,
      qty:item.qty,
      price:item.price,
      img:item.img,
      slot:time,
      token:token
    });
  });
  localStorage.setItem("purchaseHistory",JSON.stringify(history));
  localStorage.removeItem("cartItems");

  // Show “Go to Dashboard” button
  document.getElementById("dashBtn").style.display="inline-block";
}

function goDashboard(){
  window.location.href="dashboard.html";
}
</script>
</body>
</html>
